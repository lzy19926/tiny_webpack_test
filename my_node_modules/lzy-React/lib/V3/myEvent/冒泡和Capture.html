<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>


    <div id="parent">
        <button id="child">Bubble</button>
    </div>
    <br />
    <div id="parent2">
        <button id="child2">Capture</button>
    </div>

    <script>



        // --------------事件冒泡--------------------------
        // 指事件从下往上执行, 在子组件处捕获到事件对象e, 

        //! 我们点击按钮时,父组件也会执行监听器回调

        // 首先会向下捕获事件对象    父->子  
        //       此时捕获到子组件的事件对象e(重要)

        // 然后向上冒泡执行事件 子->父

        let child = document.getElementById('child')
        let parent = document.getElementById('parent')

        child.addEventListener('click', (e) => {
            console.log('点击子组件', e.target);
        })

        parent.addEventListener('click', (e) => {
            console.log('点击父组件', e.target);
        })

        // 最终这段代码会执行: 

        // 1 点击子组件  e为button的e
        // 2 点击父组件  e为button的e

        // ----------------事件捕获Capture----------------------
        // 如果在addEventListener第三个参数处设置了true,则会在事件捕获阶段执行事件(从上往下执行)(先父再子)
        let child2 = document.getElementById('child2')
        let parent2 = document.getElementById('parent2')

        child2.addEventListener('click', (e) => {
            console.log('点击子组件2', e.target);
        }, true)

        parent2.addEventListener('click', (e) => {
            console.log('点击父组件2', e.target);
        }, true)

        // 最终这段代码会执行: 

        // 1 点击父组件  e为button的e
        // 2 点击子组件  e为button的e

        const IS_CAPTURE_PHASE = 1 << 2;
        const isCapturePhaseListener = true // click一般是委派事件
        let eventSystemFlags = 0;
        if (isCapturePhaseListener) {
            eventSystemFlags |= IS_CAPTURE_PHASE;
        }

        console.log('click获取的eventSystemFlags', eventSystemFlags); // 最终为4

        let inCapturePhase = (eventSystemFlags & IS_CAPTURE_PHASE) !== 0;

        console.log('click获取的inCapturePhase', inCapturePhase); // true
    </script>
</body>

</html>