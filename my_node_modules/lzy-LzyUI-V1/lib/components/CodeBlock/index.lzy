import LzyReact, { myUseEffect } from 'lzy-react'
import Prism from '../../Prism/prism.js'
import '../../Prism/prism.css'
import './index.css'


export default function CodeBlock(props, children, fiber) {

    const { codeStr, lang = '', style } = props
    // 转换代码和lang
    const language = lang.toLowerCase()
    const html = Prism.highlight(codeStr, Prism.languages.javascript, 'javascript');

    // 在生成dom后设置innerHtml
    myUseEffect(() => {
        const codeDom = fiber._child._child.stateNode
        codeDom.innerHTML = html
    })


    return (
        <pre class={`language-${language} lzy-CodeBlock`} tabindex="0" style={style}>
            <code class={`language-${language}`}> </code>
        </pre>
    )
}